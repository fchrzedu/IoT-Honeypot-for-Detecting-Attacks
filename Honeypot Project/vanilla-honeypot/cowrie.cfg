# Custom cowrie.cfg for the vanilla honeypot, for malware testing
# This same configuration is deployed within the sandboxed honeypot
# SSH port 2222                 Telnet port 2223

# ============================================================================
# General Cowrie Options
# ============================================================================
[honeypot]

# Sensor name identifies cowrie instance - used for database logging such as SQL (future)
sensor_name=vanilla-honeypot

# Honeypot hostname displayed via shell prompt - OVERWRITTEN VIA device_profiles.py
hostname=IoT-Device

# Directory where to store logs - will store in cowrie/ for simplicity
log_path=var/log/cowrie

# Where to store downloaded artifacts (malware samples)
download_path=var/lib/cowrie/downloads

# Session timeout (3 minutes)
idle_timeout=180

# Authentication timeout (2 min)
authentication_timeout=120

# Use emulated backend shell
backend=shell

# Rotate logs
# Use `rotating` and Cowrie will log to `cowrie.log` and at midnight
# rotate to `cowrie.log-<year>-<month>-<date>.log` and continue writing
# to (a new) `cowrie.log`. (FROM cowrie.cfg.dist)
logtype=rotating

timezone=GMT

# Auth method: userDB uses etc/userdb.txt for credentials
# AuthRandom: allows login after random attempts
auth_class=UserDB

# TTY logging (records full terminal sessions)
ttylog=true
ttylog_path=${honeypot:state_path}/tty

# Download limits (0 = unlimited, useful for malware collection)
download_limit_size=0


# ============================================================================
# Shell Emulation Configuration
# ============================================================================
[shell]

# Virtual filesystem
filesystem=${honeypot:data_path}/fs.pickle

# Architecture list which matches common IoT devices
# Multiple architectures = random selection
# Current profiles: mipsel (D-Link camera), mips (TP-Link router)
arch=linux-mipsel-lsb,linux-mips-msb

# Future expansion:
# arch=linux-mipsel-lsb,linux-mips-msb,linux-arm-lsb,linux-x64-lsb

# Default fallback uname values IF device_profile.py not configured per device
kernel_version=3.10.14
kernel_build_string=#1 SMP PREEMPT Thu Jun 23 10:12:33 CST 2016
hardware_platform=mipsel
operating_system=GNU/Linux

# SSH version for internal commands
ssh_version=OpenSSH_7.9p1, OpenSSL 1.1.1a  20 Nov 2018


# ============================================================================
# SSH Configuration
# ============================================================================
[ssh]

# Enable SSH transport
enabled=true

# SSH banner (overwritten via device_profile in factory.py)
# This is just a fallback
version=SSH-2.0-OpenSSH_6.0p1 Debian-4+deb7u2

# Listen on port 2222 (use iptables to forward from port 22)
# Format: tcp:PORT:interface=IP
# For all interfaces: 0.0.0.0
# For localhost only: 127.0.0.1
listen_endpoints=tcp:2222:interface=0.0.0.0

# SSH keys (auto-generated on first run)
rsa_public_key=${honeypot:state_path}/ssh_host_rsa_key.pub
rsa_private_key=${honeypot:state_path}/ssh_host_rsa_key
ecdsa_public_key=${honeypot:state_path}/ssh_host_ecdsa_key.pub
ecdsa_private_key=${honeypot:state_path}/ssh_host_ecdsa_key
ed25519_public_key=${honeypot:state_path}/ssh_host_ed25519_key.pub
ed25519_private_key=${honeypot:state_path}/ssh_host_ed25519_key

# Supported public key types
public_key_auth=ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519

# Cipher suites (IoT devices often support weaker ciphers)
ciphers=aes128-ctr,aes192-ctr,aes256-ctr,aes256-cbc,aes192-cbc,aes128-cbc,3des-cbc

# MAC algorithms
macs=hmac-sha2-512,hmac-sha2-384,hmac-sha2-256,hmac-sha1,hmac-md5

# Compression
compression=zlib@openssh.com,zlib,none

# Enable SFTP subsystem
sftp_enabled=true

# Enable SSH forwarding (for advanced attacks)
forwarding=true


# ============================================================================
# Telnet Configuration
# ============================================================================
[telnet]

# Disabled for now - enable if testing Telnet-based attacks
enabled=false

# Telnet listen port
listen_endpoints=tcp:2223:interface=0.0.0.0


# ============================================================================
# Output Logging Configuration
# ============================================================================

# JSON logging - ESSENTIAL for data analysis
[output_jsonlog]
enabled=true
logfile=${honeypot:log_path}/cowrie.json
epoch_timestamp=false

# Text logging - human-readable logs
[output_textlog]
enabled=true
logfile=${honeypot:log_path}/cowrie.log
format=text

# Crash reporter - disabled for privacy in research
[output_crashreporter]
enabled=false


# ============================================================================
# Optional: Database Logging for Advanced Analysis
# ============================================================================

# Uncomment and configure to store logs in a database

# MySQL
#[output_mysql]
#enabled=false
#host=localhost
#database=cowrie
#username=cowrie
#password=secret
#port=3306

# PostgreSQL
#[output_postgresql]
#enabled=false
#host=localhost
#database=cowrie
#username=cowrie
#password=secret
#port=5432

# SQLite (simplest option for single honeypot)
#[output_sqlite]
#enabled=false
#db_file=var/lib/cowrie/cowrie.db

# Elasticsearch (for Kibana visualization)
#[output_elasticsearch]
#enabled=false
#host=localhost
#port=9200
#index=cowrie
